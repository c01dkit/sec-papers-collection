import{r,o as B,c as u,u as n,U as e,d as t,t as c,i as E,H as I,F as N,x as R,b as d,h as T}from"./@vue-BCP6iOYN.js";import{u as z}from"./vue-i18n-BsPu5iUC.js";import{D as G,E as k,d as v,F as H,s as S,f as V,G as L}from"./primevue-B9mc3ZvP.js";import{i as M,c as q,a as J,d as _,b as y,e as O,s as C}from"./index-waGj-Rgr.js";import{_ as P}from"./plugin-vueexport-helper-DlAUqK2U.js";import"./@intlify-D3GL-xSz.js";import"./@primeuix-DLtbeBr7.js";import"./@primevue-CD02si2e.js";import"./vue-router-CRpeqk2Z.js";/* empty css              */const Q={class:"page-shell"},W={key:0,class:"card"},X={key:1,class:"card text-center py-10"},Y={class:"text-xl font-semibold mb-2"},Z={class:"text-muted-color mb-3"},ee={key:2,class:"consent-wrapper"},se={class:"card consent-card"},te={class:"text-xl font-semibold mb-2"},le={class:"text-muted-color mb-4"},ae={class:"flex gap-3 justify-center"},oe={key:0,class:"text-muted-color text-sm mt-4"},ne={key:3,class:"card"},ie={class:"flex flex-col gap-4"},ce={class:"flex items-start justify-between gap-3 flex-wrap"},de={class:"text-sm font-medium mb-1"},re={class:"text-muted-color text-sm m-0"},ue={class:"flex flex-col gap-2"},me={class:"text-sm font-medium mb-1"},pe={class:"text-muted-color text-sm m-0"},fe={class:"flex flex-col gap-2"},ve={class:"text-sm font-medium mb-1"},_e={class:"text-muted-color text-sm m-0"},ge={class:"flex flex-col gap-2"},ye={class:"text-sm font-medium mb-1"},he={class:"text-muted-color text-sm m-0"},xe={class:"flex gap-2 flex-wrap"},we={class:"flex gap-2 flex-wrap mt-2"},be={class:"flex gap-3 justify-end flex-wrap"},ke={__name:"Settings",setup(Se){const{t:s,locale:g}=z(),m=G(),h=r(!0),x=r(!1),w=r(!1),b=r(!0),p=r(!1),l=r(_()),f=r("");B(async()=>{if(b.value=M(),!b.value){h.value=!1;return}try{const a=await q();x.value=!a,a&&await K()}catch(a){console.warn("[Settings] init failed",a)}finally{h.value=!1}});async function K(){try{const a=await J();l.value={..._(),...a},y(l.value,g)}catch(a){console.warn("[Settings] load failed",a),m.add({severity:"warn",summary:s("settings.toast.loadFailed"),life:3e3})}}async function F(){p.value=!0;try{await O(),l.value=_(),x.value=!1,w.value=!1,await C(l.value),y(l.value,g),m.add({severity:"success",summary:s("settings.toast.consentAccepted"),life:2500})}catch(a){console.error("[Settings] consent accept failed",a),m.add({severity:"error",summary:s("settings.toast.consentFailed"),life:3e3})}finally{p.value=!1}}function U(){w.value=!0,m.add({severity:"info",summary:s("settings.toast.consentRejected"),life:2500})}async function j(){p.value=!0;const a={..._(),...l.value};try{await C(a),y(a,g),m.add({severity:"success",summary:s("settings.toast.saved"),life:2500})}catch(o){console.error("[Settings] save failed",o),m.add({severity:"error",summary:s("settings.toast.saveFailed"),life:3e3})}finally{p.value=!1}}function A(){l.value=_(),f.value="",y(l.value,g)}function D(){const a=f.value.trim();if(!a)return;const o=new Set(l.value.keywords||[]);o.add(a),l.value={...l.value,keywords:Array.from(o)},f.value=""}function $(a){const o=(l.value.keywords||[]).filter(i=>i!==a);l.value={...l.value,keywords:o}}return(a,o)=>(d(),u("div",Q,[h.value?(d(),u("div",W,[n(e(k),{width:"10rem",class:"mb-3",height:"1.5rem"}),n(e(k),{width:"100%",height:"4rem",class:"mb-2"}),n(e(k),{width:"100%",height:"4rem"})])):b.value?x.value?(d(),u("div",ee,[t("div",se,[t("h2",te,c(e(s)("settings.consent.title")),1),t("p",le,c(e(s)("settings.consent.desc")),1),t("div",ae,[n(e(v),{label:e(s)("settings.consent.reject"),class:"p-button-text",onClick:U},null,8,["label"]),n(e(v),{label:e(s)("settings.consent.accept"),loading:p.value,onClick:F},null,8,["label","loading"])]),w.value?(d(),u("p",oe,c(e(s)("settings.consent.declinedNote")),1)):E("",!0)])])):(d(),u("div",ne,[t("div",ie,[t("div",ce,[t("div",null,[t("p",de,c(e(s)("settings.form.showStatusDots.label")),1),t("p",re,c(e(s)("settings.form.showStatusDots.desc")),1)]),n(e(H),{modelValue:l.value.showStatusDots,"onUpdate:modelValue":o[0]||(o[0]=i=>l.value.showStatusDots=i)},null,8,["modelValue"])]),n(e(S)),t("div",ue,[t("p",me,c(e(s)("settings.form.llmUrl.label")),1),t("p",pe,c(e(s)("settings.form.llmUrl.desc")),1),n(e(V),{modelValue:l.value.llmEndpoint,"onUpdate:modelValue":o[1]||(o[1]=i=>l.value.llmEndpoint=i),class:"w-full",placeholder:e(s)("settings.form.llmUrl.placeholder")},null,8,["modelValue","placeholder"])]),t("div",fe,[t("p",ve,c(e(s)("settings.form.llmKey.label")),1),t("p",_e,c(e(s)("settings.form.llmKey.desc")),1),n(e(V),{modelValue:l.value.llmApiKey,"onUpdate:modelValue":o[2]||(o[2]=i=>l.value.llmApiKey=i),class:"w-full",type:"password",placeholder:e(s)("settings.form.llmKey.placeholder")},null,8,["modelValue","placeholder"])]),n(e(S)),t("div",ge,[t("p",ye,c(e(s)("settings.form.keywords.label")),1),t("p",he,c(e(s)("settings.form.keywords.desc")),1),t("div",xe,[n(e(V),{modelValue:f.value,"onUpdate:modelValue":o[3]||(o[3]=i=>f.value=i),class:"flex-1 min-w-[200px]",placeholder:e(s)("settings.form.keywords.placeholder"),onKeyup:I(D,["enter"])},null,8,["modelValue","placeholder"]),n(e(v),{label:e(s)("settings.form.keywords.add"),size:"small",onClick:D},null,8,["label"])]),t("div",we,[(d(!0),u(N,null,R(l.value.keywords||[],i=>(d(),T(e(L),{key:i,value:i,class:"cursor-pointer",icon:"pi pi-times",onClick:Ve=>$(i)},null,8,["value","onClick"]))),128))])])]),n(e(S),{class:"my-4"}),t("div",be,[n(e(v),{label:e(s)("settings.actions.reset"),class:"p-button-text",onClick:A},null,8,["label"]),n(e(v),{label:e(s)("settings.actions.save"),loading:p.value,onClick:j},null,8,["label","loading"])])])):(d(),u("div",X,[t("h2",Y,c(e(s)("settings.unsupported.title")),1),t("p",Z,c(e(s)("settings.unsupported.desc")),1)]))]))}},Ie=P(ke,[["__scopeId","data-v-a5a66022"]]);export{Ie as default};
